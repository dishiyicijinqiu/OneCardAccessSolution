<html>

<head>
    <link href="../../Content/Site.css" rel="stylesheet" type="text/css" />
    <script src="../../Scripts/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="../../Scripts/OneCardAccess.js"></script>
    <script type="text/javascript">

        var params = {
            left: 0,
            top: 0,
            currentX: 0,
            currentY: 0,
            flag: false
        };
        //拖拽的实现
        var startDrag = function (target) {
            if (target.css("left") !== 'auto') {
                params.left = target.css("left");
            }
            if (target.css("top") !== 'auto') {
                params.top = target.css("top");
            }
            target.mousedown(function (event) {
                params.flag = true;
                if (!event) {
                    event = window.event;
                    //防止IE文字选中
                    target.onselectstart = function () {
                        return false;
                    }
                }
                params.currentX = event.clientX;
                params.currentY = event.clientY;
            });
            document.onmouseup = function () {
                params.flag = false;
                if (target.css("left") !== 'auto') {
                    params.left = target.css("left");
                }
                if (target.css("top") !== 'auto') {
                    params.top = target.css("top");
                }
            };
            document.onmousemove = function (event) {
                var e = event ? event : window.event;
                if (params.flag) {
                    var nowX = e.clientX, nowY = e.clientY;
                    var disX = nowX - params.currentX, disY = nowY - params.currentY;
                    window.external.SetMovePos(disX, disY);
                }
            }
        };

        //最小化窗体的实现
        var minWindow = function (target) {
            target.click(function () {
                window.external.MinWindow();
            });
        };
        //最大化窗体的实现
        var maxWindow = function (target) {
            target.click(function () {
                window.external.MaxWindow();
            });
        };
        //顶部最大化窗体的实现
        var topMaxWindow = function (target) {
            target.dblclick(function () {
                window.external.MaxWindow();
            });
        };
        //关闭窗体的实现
        var closeWindow = function (target) {
            target.click(function () {
                window.external.Close();
            });
        };
        //最小化滑过
        var minHover = function (target) {
            target.mouseover(function () {
                $("#divWindowStatus").css("background-position", "0px 63px")
            }).mouseleave(function () {
                $("#divWindowStatus").css("background-position", "0px 0px")
            });
        };
        //最大化滑过
        var maxHover = function (target) {
            target.mouseover(function () {
                $("#divWindowStatus").css("background-position", "0px 42px")
            }).mouseleave(function () {
                $("#divWindowStatus").css("background-position", "0px 0px")
            });
        };
        //关闭滑过
        var closeHover = function (target) {
            target.mouseover(function () {
                $("#divWindowStatus").css("background-position", "0px 21px")
            }).mouseleave(function () {
                $("#divWindowStatus").css("background-position", "0px 0px")
            });
        };

        $(function () {
            $(document).ready(function () {
                var eTop = $("#divTop");
                startDrag(eTop);
                topMaxWindow(eTop);
                var eMin = $("#divMin");
                minHover(eMin);
                minWindow(eMin);
                var eMax = $("#divMax");
                maxHover(eMax);
                maxWindow(eMax);
                var eClose = $("#divClose");
                closeHover(eClose);
                closeWindow(eClose);
            });
        });

    </script>
</head>
<body style="border:0px;margin:0;padding:0;" scroll="no">
    <div id="divTop" style="width:100%;height:28px; position:absolute;right:-96px;top:0px;background-image:url('../../Content/Images/Transport.png'); background-repeat:repeat;">
        <div id="divWindowStatus" style="width:100px;height:21px;position:absolute;right:100px;top:4px;background-image:url(windowstatus.png);">
            <div id="divMin" style="width:33px;height:21px;float:left"></div>
            <div id="divMax" style="width:33px;height:21px;float:left"></div>
            <div id="divClose" style="width:33px;height:21px;float:left"></div>
        </div>
    </div>
    <iframe id="myiframe" src="../../Home/Index" style="width:100%; height:100%;border:0px;" frameborder="0"></iframe>
</body>
</html>